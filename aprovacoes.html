<script>
  if (localStorage.getItem("tipo") !== "admin") {
    window.location.href = "login.html";
  }

  const solicitacoes = JSON.parse(localStorage.getItem("solicitacoes") || "[]");
  const usuarios = JSON.parse(localStorage.getItem("usuarios") || "[]");
  const container = document.getElementById("listaSolicitacoes");

  if (solicitacoes.length === 0) {
    container.innerHTML = '<p class="text-center text-gray-500">Nenhuma solicitação pendente.</p>';
  } else {
    solicitacoes.forEach((user, i) => {
      const card = document.createElement("div");
      card.className = "bg-white shadow rounded-xl p-4 flex justify-between items-center";
      card.innerHTML = `
        <div>
          <p><strong>Nome:</strong> ${user.nome}</p>
          <p><strong>CPF:</strong> ${user.cpf}</p>
          <p><strong>Login:</strong> ${user.login}</p>
        </div>
        <div class="flex gap-2">
          <button class="bg-green-600 text-white px-3 py-1 rounded" onclick="aprovar(${i})">Aprovar</button>
          <button class="bg-red-600 text-white px-3 py-1 rounded" onclick="rejeitar(${i})">Rejeitar</button>
        </div>
      `;
      container.appendChild(card);
    });
  }

  function aprovar(index) {
    const novo = solicitacoes[index];
    usuarios.push({
      usuario: novo.login,
      senha: novo.senha,
      tipo: "usuario"
    });
    solicitacoes.splice(index, 1);
    localStorage.setItem("usuarios", JSON.stringify(usuarios));
    localStorage.setItem("solicitacoes", JSON.stringify(solicitacoes));
    alert("Usuário aprovado com sucesso!");
    location.reload();
  }

  function rejeitar(index) {
    solicitacoes.splice(index, 1);
    localStorage.setItem("solicitacoes", JSON.stringify(solicitacoes));
    alert("Solicitação rejeitada.");
    location.reload();
  }
</script>
