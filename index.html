<!DOCTYPE html>
<html lang=\"pt-br\">
<head>
    <meta charset=\"UTF-8\">
    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
    <title>Simulador Regularização Fundiária</title>
    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">
</head>
<body>
<div class=\"container my-4\">

    <div class=\"mb-3\">
        <button class=\"btn btn-success\" onclick=\"window.open('status.html?status=Ativo', '_blank')\">Ativo</button>
        <button class=\"btn btn-warning\" onclick=\"window.open('status.html?status=Cartório', '_blank')\">Cartório</button>
        <button class=\"btn btn-primary\" onclick=\"window.open('status.html?status=Vistoria', '_blank')\">Vistoria</button>
        <button class=\"btn btn-danger\" onclick=\"window.open('status.html?status=Sem solução', '_blank')\">Sem solução</button>
        <button class=\"btn btn-secondary\" onclick=\"carregarDados()\">Atualizar Dados</button>
    </div>

    <table class=\"table table-bordered\">
        <thead>
        <tr>
            <th>Interessado/Requerente</th>
            <th>CPF</th>
            <th>Nº Processo/Protocolo</th>
            <th>Data Abertura</th>
            <th>Telefone</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody id=\"tabela\"></tbody>
    </table>
</div>

<script>
function carregarDados(statusFiltro = null) {
    document.getElementById(\"tabela\").innerHTML = \"\";
    fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vSy01pb1a-_Nq2BY7Qaf5TpEkawEcxd7e3PyR8a5eS0DC2VE8EaB8iSdXXnNy8b2fOxW-vO_vkAAMsI/pub?gid=1097337137&single=true&output=csv')
      .then(response => response.text())
      .then(csvText => {
        const linhas = csvText.split('\\n');
        linhas.splice(0, 2); // Remove as duas primeiras linhas (cabeçalhos ou descrições)
        linhas.forEach(linha => {
            const colunas = linha.split(',');
            const nome = colunas[5]; // coluna F
            const cpf = colunas[6]; // coluna G
            const processo = colunas[23]; // coluna X
            const data = colunas[24]; // coluna Y
            const telefone = colunas[8]; // coluna I
            const status = colunas[25]; // coluna Z (exemplo da coluna de status)

            if (!statusFiltro || status === statusFiltro) {
                adicionarLinha(nome, cpf, processo, data, telefone, status);
            }
        });
    });
}

function adicionarLinha(nome, cpf, processo, data, telefone, status = 'Selecionar') {
    const tabela = document.getElementById(\"tabela\");
    const novaLinha = document.createElement('tr');
    novaLinha.innerHTML = `<td>${nome}</td><td>${cpf}</td><td>${processo}</td><td>${data}</td><td>${telefone}</td><td>${status}</td>`;
    tabela.appendChild(novaLinha);
}

function obterParametro(nome) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(nome);
}

window.onload = function() {
    const status = obterParametro('status');
    carregarDados(status);
};
</script>
</body>
</html>
