
<!doctype html>
<html lang=pt-br>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Análise de Vídeos</title>
<link href=https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css rel=stylesheet>
<script src=https://cdn.jsdelivr.net/npm/chart.js></script>
<script>document.addEventListener("contextmenu",(e=>e.preventDefault())),document.addEventListener("keydown",(function(e){("F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&"U"===e.key)&&(e.preventDefault(),alert("Ação bloqueada por segurança."))}))</script>
</head>
<body class="bg-gray-100 text-gray-800">
<header class="bg-white shadow-md p-4 flex items-center justify-between">
<h1 class="text-2xl font-bold text-blue-600">🎥 Análise de Vídeos</h1>
<a href=index.html class="flex items-center text-sm text-blue-600 hover:underline">
<svg xmlns=http://www.w3.org/2000/svg class="h-4 w-4 mr-1" fill=none viewBox="0 0 24 24" stroke=currentColor>
<path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M15 19l-7-7 7-7"/>
</svg>
Voltar
</a>
</header>
<main class="p-6 max-w-6xl mx-auto">
Página para mostrar estatísticas detalhadas por vídeo.

<section class="mb-6">
  <h2 class="text-xl font-bold text-blue-600 mb-2">💬 Comentários & Reações</h2>
  <ul class="text-gray-700 text-sm list-disc pl-6 space-y-1">
    <li>😄 Análise de sentimentos dos comentários</li>
    <li>🗣️ Palavras mais usadas pelos seguidores</li>
    <li>🔁 Tópicos que mais geram reação</li>
  </ul>
</section>

<div id="comentariosContainer" class="mt-6"></div>

<div class="mb-4">
  <label for="videoSelect" class="block text-sm font-medium text-gray-700 mb-1">Selecione um vídeo:</label>
  <select id="videoSelect" class="w-full border rounded px-3 py-2"></select>
</div>
<div class="mb-4">
  <label for="palavraChave" class="block text-sm font-medium text-gray-700 mb-1">Filtrar por palavra-chave:</label>
  <input type="text" id="palavraChave" placeholder="Ex: engraçado, ruim, legal..." class="w-full px-3 py-2 border rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400">
</div>
<div id="comentariosContainer" class="mt-6"></div>

</main>
<script>
  document.addEventListener("DOMContentLoaded", async function () {
    const url = localStorage.getItem("canal_jairinho_url") || "";
    const rede = localStorage.getItem("canal_rede") || "youtube";
    const container = document.getElementById("comentariosContainer");
    const select = document.getElementById("videoSelect");
    const filtro = document.getElementById("palavraChave");

    let comentariosGerados = [];

    if (rede === "youtube") {
      const nomeUsuario = url.split("@")[1] || "FalaJairinho";
      const apiKey = "AIzaSyCD27OXrL7tmgDxOg7wQLR5QmRUGJPsqFg";

      try {
        const busca = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=@${nomeUsuario}&type=channel&key=${apiKey}`);
        const canal = await busca.json();
        const channelId = canal.items?.[0]?.snippet?.channelId || canal.items?.[0]?.id?.channelId;

        const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${channelId}&order=viewCount&maxResults=6&key=${apiKey}`);
        const data = await res.json();

        // preencher o select
        data.items.forEach((video, i) => {
          const option = document.createElement("option");
          option.value = video.snippet.title;
          option.textContent = video.snippet.title;
          select.appendChild(option);
        });

        select.addEventListener("change", function () {
          const titulo = select.value;
          const palavrasBase = ["sensacional", "ruim", "engraçado", "legal", "confuso", "sem noção"];
          comentariosGerados = palavrasBase.map((palavra, i) => {
            return {
              autor: "Usuário " + (i + 1),
              texto: `${palavra} esse vídeo sobre ${titulo.toLowerCase()}`,
              sentimento: palavra.includes("ruim") || palavra.includes("confuso") ? "negativo" :
                          palavra.includes("sem") ? "neutro" : "positivo"
            };
          });
          renderizarComentarios();
        });

        filtro.addEventListener("input", function () {
          renderizarComentarios();
        });

        function renderizarComentarios() {
          const palavra = filtro.value.toLowerCase();
          const lista = comentariosGerados.filter(c => c.texto.toLowerCase().includes(palavra));
          container.innerHTML = lista.map(c => {
            const cor = c.sentimento === "positivo" ? "text-green-600" :
                        c.sentimento === "negativo" ? "text-red-600" : "text-gray-600";
            return `
              <div class="bg-white p-4 rounded shadow border mb-3">
                <p class="text-sm text-gray-800"><strong>${c.autor}</strong>: ${c.texto}</p>
                <p class="text-xs ${cor}">Sentimento: ${c.sentimento}</p>
              </div>
            `;
          }).join("") || "<p class='text-sm text-gray-500'>Nenhum comentário com essa palavra.</p>";
        }
      } catch (err) {
        container.innerHTML = "<p class='text-sm text-red-600'>Erro ao carregar vídeos do canal.</p>";
      }

    } else {
      container.innerHTML = "<p class='text-sm text-gray-700'>Seleção de vídeos disponível apenas para canais YouTube.</p>";
    }
  });
</script>

</body>
</html>

<script>
  document.addEventListener("DOMContentLoaded", async function () {
    const url = localStorage.getItem("canal_jairinho_url") || "";
    const rede = localStorage.getItem("canal_rede") || "youtube";
    const container = document.getElementById("comentariosContainer");
    container.innerHTML = "Carregando comentários...";

    const comentariosFalsos = [
      { autor: "Carlos", texto: "Esse vídeo tá sensacional 🔥", sentimento: "positivo" },
      { autor: "Joana", texto: "Achei meio sem graça", sentimento: "neutro" },
      { autor: "Marcos", texto: "Não gostei da abordagem", sentimento: "negativo" },
      { autor: "Larissa", texto: "Muito bom! Ri demais 😂", sentimento: "positivo" },
      { autor: "Thiago", texto: "Achei confuso", sentimento: "neutro" }
    ];

    if (rede === "youtube") {
      // Simular busca de comentários + análise básica
      const blocos = comentariosFalsos.map(c => {
        const cor = c.sentimento === "positivo" ? "text-green-600" :
                    c.sentimento === "negativo" ? "text-red-600" : "text-gray-600";
        return `
          <div class="bg-white p-4 rounded shadow border mb-3">
            <p class="text-sm text-gray-800"><strong>${c.autor}</strong>: ${c.texto}</p>
            <p class="text-xs ${cor}">Sentimento: ${c.sentimento}</p>
          </div>
        `;
      }).join("");
      container.innerHTML = blocos;
    } else {
      // Simulação para TikTok/Instagram
      container.innerHTML = `
        <p class="text-sm text-gray-700 mb-3">Exibindo comentários simulados para <strong>${rede}</strong>.</p>
        <div class="bg-white p-4 rounded shadow border mb-3">"Top demais esse conteúdo" — Sentimento: positivo</div>
        <div class="bg-white p-4 rounded shadow border mb-3">"Poderia ser mais curto" — Sentimento: neutro</div>
        <div class="bg-white p-4 rounded shadow border mb-3">"Não curti" — Sentimento: negativo</div>
      `;
    }
  });
</script>
